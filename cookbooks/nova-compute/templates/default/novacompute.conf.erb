[DEFAULT]
#this is for nova
my_ip = <%= node['ipaddress'] %>
use_ipv6 = false
logdir=/var/log/nova
state_path=/var/lib/nova
lock_path=/var/lock/nova
force_dhcp_release=True
libvirt_use_virtio_for_bridges=True
ec2_private_dns_show_ip=True
api_paste_config=/etc/nova/api-paste.ini
enabled_apis=ec2,osapi_compute,metadata
verbose = true
rpc_backend = rabbit
auth_strategy = keystone
state_path = /mnt/raid1/nova
instances_path = /mnt/raid1/nova/instances

rabbit_host = <%= node['rabbitmq']['host_ip'] %>
rabbit_userid = <%= node['rabbitmq']['user'] %>
rabbit_password = <%= node['rabbitmq']['passwd'] %>


# for telemetry
instance_usage_audit = True
instance_usage_audit_period = hour
notify_on_state_change = vm_and_task_state
notification_driver = messagingv2

#this is for nova-network

dhcpbridge_flagfile=/etc/nova/nova.conf
dhcpbridge=/usr/bin/nova-dhcpbridge
force_dhcp_release=True
libvirt_use_virtio_for_bridges=True
network_driver = nova.network.linux_net
libvirt_vif_driver = nova.virt.libvirt.vif.LibvirtGenericVIFDriver
linuxnet_interface_driver = nova.network.linux_net.LinuxBridgeInterfaceDriver
firewall_driver = nova.virt.libvirt.firewall.IptablesFirewallDriver
network_api_class = nova.network.api.API
security_group_api = nova
network_manager = nova.network.manager.FlatDHCPManager
network_size = 254
allow_same_net_traffic = False
multi_host = True
send_arp_for_ha = True
share_dhcp_address = True
force_dhcp_release = True
flat_network_bridge = br-ex
flat_interface = eth1
public_interface = eth0

[vnc]
vnc_enabled = True
vncserver_listen = 0.0.0.0
vncserver_proxyclient_address = <%= node['hostname'] %> 
novncproxy_base_url = http://<%= node['nova-compute']['host_ip'] %>:6080/vnc_auto.html

[database]
connection=mysql://<%= node['nova-compute']['db_user'] %>:<%= node['nova-compute']['db_pass'] %>@<%= node['nova-compute']['management_ip'] %>/nova

[keystone_authtoken]
auth_uri = http://<%= node['nova-compute']['management_ip'] %>:5000
auth_url = http://<%= node['nova-compute']['management_ip'] %>:35357
auth_plugin = password
project_domain_id = default
user_domain_id = default
project_name = service
username = <%= node['nova-compute']['db_user'] %>
password = <%= node['nova-compute']['db_pass'] %>

[glance]
host = <%= node['glance']['management_ip'] %>

[oslo_concurrency]
lock_path = /var/lib/nova/tmp

[cinder]
os_region_name = RegionOne
================================================================================

## This file managed by Chef, all changes will be overwritten ##

[DEFAULT]

#Scheduler
scheduler_default_filters =  AggregateMultiTenancyIsolation,AggregateInstanceExtraSpecsFilter,AvailabilityZoneFilter,CoreFilter, RamFilter
scheduler_driver=nova.scheduler.filter_scheduler.FilterScheduler
cpu_allocation_ratio=1.0
ram_allocation_ratio=1.0

#Default quota
quota_cores = 16
quota_fixed_ips = -1
quota_floating_ips = 0
quota_instances = 16
quota_ram = 49152


#Keep Connections under controll
metadata_workers=2
osapi_compute_workers=2
ec2_workers=2
#https://bugs.launchpad.net/nova/+bug/1225655
rpc_conn_pool_size=100
rpc_response_timeout=200

#Ephemeral disks should default to ext4.  Doing this in hopes of making cloud-init happier
default_ephemeral_format = ext4
#Not sure we still need this next line...probably not.
preallocate_images = space

##Dnsmasq sighup issue
##It either is SIGHUP to fast or not at all, whcih means dhcp leases arent loaded into dnsmasq
report_interval = 15
agent_down_time = 30


dhcpbridge_flagfile=/etc/nova/nova.conf
dhcpbridge=/usr/bin/nova-dhcpbridge
logdir=/var/log/nova
state_path=/var/lib/nova
lock_path=/var/lock/nova
force_dhcp_release=True
iscsi_helper=tgtadm
libvirt_use_virtio_for_bridges=True
connection_type=libvirt
root_helper=sudo nova-rootwrap /etc/nova/rootwrap.conf
verbose=True
debug=True
ec2_private_dns_show_ip=True
api_paste_config=/etc/nova/api-paste.ini
volumes_path=/var/lib/nova/volumes
enabled_apis=ec2,osapi_compute,metadata

auth_strategy=keystone

multi_instance_display_name_template = %(name)s-%(count)s


#Legacy Networking
network_manager=nova.network.manager.FlatDHCPManager
firewall_driver=nova.virt.libvirt.firewall.IptablesFirewallDriver
network_size=65535
allow_same_net_traffic=True
multi_host=True
send_arp_for_ha=True
share_dhcp_address=True
force_dhcp_release=True
flat_interface=bond0
public_interface=bond0.3526
flat_network_bridge=virbr1
network_api_class = nova.network.api.API
security_group_api = nova
#iptables_top_regex='\-\S FORWARD'
iptables_top_regex='\-\S\s+INPUT|\-\S\s+OUTPUT|\-\S\s+FORWARD'


#VNC
my_ip=10.32.0.24
vncserver_listen=127.0.0.1
vncserver_proxyclient_address=10.32.0.24

#RabbitMQ
[oslo_messaging_rabbit]
rpc_backend=rabbit
rabbit_host = api-igsb.osdc.io
rabbit_password = Ledooth1
rabbit_retry_interval=5
rabbit_retry_backoff=5
rabbit_userid = openstack


#Glance
# glance_host=api-igsb.osdc.io

#Ceilometer
instance_usage_audit = True
instance_usage_audit_period = hour
notify_on_state_change = vm_and_task_state
notification_driver = nova.openstack.common.notifier.rpc_notifier
notification_driver = ceilometer.compute.nova_notifier



[database]
connection = mysql://nova:ohhaiteikooghahghoohisohfefeebak@mysql-igsb.osdc.io/nova
max_pool_size=30
max_retries=20
retry_interval=15
connection_debug=20


[keystone_authtoken]
auth_uri = http://api-igsb.osdc.io:5000
auth_host = api-igsb.osdc.io
auth_port = 35357
auth_protocol = http
admin_tenant_name = service
admin_user = nova
admin_password = toceewaihaenaitheexootheiloosaiy


[glance]
api_servers=http://api-igsb.osdc.io:9292
host = api-igsb.osdc.io
port = 9292

# This file was auto-generated by Chef for 10.32.0.24
