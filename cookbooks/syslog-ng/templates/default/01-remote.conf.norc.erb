## This file managed by Chef, all changes will be overwritten ##

source remote_src {
tcp( ip("0.0.0.0")
port("1999"),
# transport("tls")
tls(
key_file("/etc/ssl/private/syslog.norc.opensciencedatacloud.org.key")
cert_file("/etc/ssl/certs/syslog.norc.opensciencedatacloud.org.crt")
peer_verify(optional-untrusted)
),
max-connections(8192),log_iw_size(300000000),log_fetch_limit(2000000)
);
};
 
#VMs are based on instnace-id
#create_dirs(yes);
 
destination remote_auth { file("/var/log/vms/$FULLHOST/auth.log"); };
destination remote_cron { file("/var/log/vms/$FULLHOST/cron.log"); };
destination remote_daemon { file("/var/log/vms/$FULLHOST/daemon.log"); };
destination remote_kern { file("/var/log/vms/$FULLHOST/kern.log"); };
destination remote_lpr { file("/var/log/vms/$FULLHOST/lpr.log"); };
destination remote_mail { file("/var/log/vms/$FULLHOST/mail.log"); };
destination remote_syslog { file("/var/log/vms/$FULLHOST/syslog"); };
destination remote_user { file("/var/log/vms/$FULLHOST/user.log"); };
destination remote_uucp { file("/var/log/vms/$FULLHOST/uucp.log"); };
destination remote_mailinfo { file("/var/log/vms/$FULLHOST/mail/mail.info"); };
destination remote_mailwarn { file("/var/log/vms/$FULLHOST/mail/mail.warn"); };
destination remote_mailerr { file("/var/log/vms/$FULLHOST/mail/mail.err"); };
destination remote_newscrit { file("/var/log/vms/$FULLHOST/news/news.crit"); };
destination remote_newserr { file("/var/log/vms/$FULLHOST/news/news.err"); };
destination remote_newsnotice { file("/var/log/vms/$FULLHOST/news/news.notice"); };
destination remote_debug { file("/var/log/vms/$FULLHOST/debug"); };
destination remote_error { file("/var/log/vms/$FULLHOST/error"); };
destination remote_messages { file("/var/log/vms/$FULLHOST/messages"); };
destination remote_ppp { file("/var/log/vms/$FULLHOST/ppp.log"); };
 
#destination remote_keylogger { file("/var/log/vms/$FULLHOST/keylogger.log"); };
#filter f_keylogger { match("KEYLOGGER" value("MESSAGE") ); };
#log { source(remote_src); filter(f_keylogger); destination(remote_keylogger); };
 
log { source(remote_src); filter(f_auth); destination(remote_auth); flags(flow-control);};
log { source(remote_src); filter(f_cron); destination(remote_cron); flags(flow-control);};
log { source(remote_src); filter(f_daemon); destination(remote_daemon); flags(flow-control);};
log { source(remote_src); filter(f_kern); destination(remote_kern); flags(flow-control);};
log { source(remote_src); filter(f_lpr); destination(remote_lpr); flags(flow-control);};
log { source(remote_src); filter(f_syslog3); destination(remote_syslog); flags(flow-control);};
log { source(remote_src); filter(f_user); destination(remote_user); flags(flow-control);};
log { source(remote_src); filter(f_uucp); destination(remote_uucp); flags(flow-control);};
log { source(remote_src); filter(f_mail); destination(remote_mail); flags(flow-control);};
#log { source(remote_src); filter(f_mail); filter(f_info); destination(remote_mailinfo); flags(flow-control);};
#log { source(remote_src); filter(f_mail); filter(f_warn); destination(remote_mailwarn); flags(flow-control);};
#log { source(remote_src); filter(f_mail); filter(f_err); destination(remote_mailerr); flags(flow-control);};
log { source(remote_src); filter(f_news); filter(f_crit); destination(remote_newscrit); flags(flow-control);};
log { source(remote_src); filter(f_news); filter(f_err); destination(remote_newserr); flags(flow-control);};
log { source(remote_src); filter(f_news); filter(f_notice); destination(remote_newsnotice); flags(flow-control);};
#log { source(remote_src); filter(f_cnews); destination(remote_console_all); flags(flow-control);};
#log { source(remote_src); filter(f_cother); destination(remote_console_all); flags(flow-control);};
#log { source(remote_src); filter(f_ppp); destination(remote_ppp); flags(flow-control);};
log { source(remote_src); filter(f_debug); destination(remote_debug); flags(flow-control);};
log { source(remote_src); filter(f_error); destination(remote_error); flags(flow-control);};
log { source(remote_src); filter(f_messages); destination(remote_messages); flags(flow-control);};


# This file was auto-generated by Chef for <%=node['ipaddress']%>
